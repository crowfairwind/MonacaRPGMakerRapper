<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <meta http-equiv="Content-Security-Policy"
        content="default-src * data: gap: content: https://ssl.gstatic.com;
                 style-src * 'unsafe-inline';
                 script-src * 'unsafe-inline' 'unsafe-eval'">

  <!-- Monaca -->
  <script src="components/loader.js"></script>

  <!-- AdMob ブリッジ（親側） -->
  <script src="js/ad_bridge_parent.js"></script>

  <link rel="stylesheet" href="components/loader.css">
  <link rel="stylesheet" href="css/style.css">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
    }

    #wrap {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      -webkit-transform: translate(-50%, -50%);
    }

    #gameFrame {
      border: 0;
      display: block;
    }
  </style>
</head>

<body>
  <div id="wrap">
    <iframe
      id="gameFrame"
      allowfullscreen
      sandbox="allow-popups allow-same-origin allow-scripts">
    </iframe>
  </div>

  <script>
    // RPGツクールMV ゲーム本体
    // www/rpg/index.html
    const GAME_SRC = "rpg/index.html";

    // ゲームの論理解像度（gamestart.html から移植）
    const GAME_WIDTH  = 528;
    const GAME_HEIGHT = 912;

    function iframeZoom() {
      const iframe = document.getElementById("gameFrame");
      iframe.width  = GAME_WIDTH;
      iframe.height = GAME_HEIGHT;

      const w = document.documentElement.clientWidth  / GAME_WIDTH;
      const h = document.documentElement.clientHeight / GAME_HEIGHT;
      const zoom = Math.min(w, h);

      iframe.style.transform = `scale(${zoom})`;
      iframe.style.WebkitTransform = `scale(${zoom})`;
      iframe.focus();
    }

    function iframeLoad() {
      document.getElementById("gameFrame").src = GAME_SRC;
    }

    document.addEventListener("deviceready", () => {
      // Cordova 起動完了後に iframe 表示
      setTimeout(() => {
        iframeZoom();
        iframeLoad();
      }, 300);
    }, false);

    window.addEventListener("resize", iframeZoom);
  </script>
</body>
</html>
